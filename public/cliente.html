<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Eventos - Titi Invita</title>
    <link rel="stylesheet" href="cliente.css">
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos mejorados */
        .role-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 8px;
        }
        
        .role-badge.admin { background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; }
        .role-badge.organizador { background: linear-gradient(135deg, #FF9800, #F57C00); color: white; }
        .role-badge.cliente { background: linear-gradient(135deg, #2196F3, #1565C0); color: white; }
        .role-badge.colaborador { background: linear-gradient(135deg, #9C27B0, #7B1FA2); color: white; }
        
        .btn-logout {
            background: linear-gradient(135deg, #f44336, #d32f2f) !important;
            color: white !important;
            transition: all 0.3s !important;
        }
        
        .btn-logout:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4) !important;
        }
        
        .btn-eliminar-evento {
            background: linear-gradient(135deg, #f44336, #d32f2f) !important;
            color: white !important;
            padding: 16px 24px !important;
            border: none !important;
            border-radius: 12px !important;
            font-weight: 600 !important;
            font-size: 1rem !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            width: 100% !important;
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3) !important;
        }
        
        .btn-eliminar-evento:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.5) !important;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex !important;
        }
        
        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideInModal 0.3s ease;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        @keyframes slideInModal {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-invitado .modal-header h2 {
            font-size: 2rem;
            color: #2d3748;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .modal-invitado .modal-header h2 i {
            color: #764ba2;
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
            font-size: 0.95rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
            box-sizing: border-box;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 4px rgba(118,75,162,0.1);
            transform: translateY(-2px);
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #cbd5e0;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #764ba2, #9a7bb8) !important;
            color: white !important;
            padding: 18px 32px !important;
            border: none !important;
            border-radius: 12px !important;
            font-size: 1.1rem !important;
            font-weight: 600 !important;
            width: 100% !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            box-shadow: 0 4px 12px rgba(118,75,162,0.3) !important;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(118,75,162,0.4) !important;
        }
        
        .btn-secondary {
            background: #e2e8f0 !important;
            color: #2d3748 !important;
            padding: 14px 24px !important;
            border: none !important;
            border-radius: 12px !important;
            cursor: pointer !important;
            font-weight: 600 !important;
            width: 100% !important;
            margin-top: 12px !important;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0 !important;
        }
        
        .cliente-main {
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            height: 100vh;
            overflow: hidden;
        }
        
        .event-panel {
            overflow-y: auto;
            height: 100vh;
        }
        
        .mesas-section {
            overflow-y: auto;
            height: 100vh;
        }
        
        .config-panel {
            overflow-y: auto;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .tabs {
            position: sticky;
            top: 0;
            z-index: 10;
            background: white;
            border-bottom: 2px solid #e2e8f0;
            flex-shrink: 0;
        }
        
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* Mesas Header SIN botones molestos */
        .mesas-header {
            padding: 20px;
            background: white;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mesas-header h2 {
            margin: 0;
            color: #2d3748;
            font-size: 1.5rem;
        }

        .controls {
            display: flex;
            gap: 8px;
        }
    </style>
</head>
<body>
    <main class="cliente-main">
        <!-- COLUMNA 1: Panel de Eventos -->
        <aside class="event-panel">
            <div class="panel-section">
                <div class="logo">
                    <i class="fas fa-chair"></i>
                    <h1>Titi Invita</h1>
                </div>
                
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <strong id="userName">Usuario</strong>
                        <div>
                            <small id="userRole">Cliente</small>
                            <span id="roleBadge" class="role-badge cliente">CLIENTE</span>
                        </div>
                    </div>
                </div>
                
                <div class="event-selector-container">
                    <h3><i class="fas fa-calendar-alt"></i> Seleccionar Evento</h3>
                    <div class="event-selector">
                        <select id="eventSelector">
                            <option value="">Seleccionar Evento...</option>
                        </select>
                        <div class="event-selector-buttons">
                            <button class="btn-icon" id="newEventBtn" title="Nuevo Evento">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="btn-icon" id="refreshEventsBtn" title="Actualizar">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="current-event-info">
                        <h4>Evento Actual:</h4>
                        <h2 id="currentEventName">Sin evento</h2>
                        <p id="currentEventDate">-</p>
                        <p id="currentEventStatus">Estado: <span>-</span></p>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="btn-icon btn-logout" id="logoutBtn" title="Cerrar Sesi√≥n" onclick="mostrarConfirmacionLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                    <button class="btn-icon" id="fullscreenBtn" title="Pantalla Completa">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
            
            <div class="panel-section quick-stats">
                <h3><i class="fas fa-tachometer-alt"></i> Vista R√°pida</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="statTotalMesas">0</div>
                        <div class="stat-label">Mesas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statTotalSillas">0</div>
                        <div class="stat-label">Sillas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statSillasOcupadas">0</div>
                        <div class="stat-label">Ocupadas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statPorcentajeOcupacion">0%</div>
                        <div class="stat-label">Ocupaci√≥n</div>
                    </div>
                </div>
            </div>
            
            <div class="panel-section event-stats">
                <h3><i class="fas fa-chart-pie"></i> Resumen</h3>
                <div class="stats-list">
                    <div class="stat-row">
                        <span class="count-label">Confirmados</span>
                        <span class="count" id="confirmados">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="count-label">Pendientes</span>
                        <span class="count" id="pendientes">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="count-label">Rechazados</span>
                        <span class="count" id="rechazados">0</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- COLUMNA 2: Renderizado de Mesas (SIN botones molestos) -->
        <section class="mesas-section">
            <div class="mesas-header">
                <h2><i class="fas fa-chair"></i> Disposici√≥n de Mesas</h2>
                <div class="controls">
                    <button class="btn-icon" id="btnZoomIn" title="Acercar">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="btn-icon" id="btnZoomOut" title="Alejar">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button class="btn-icon" id="btnFullscreen" title="Pantalla Completa">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
            <div class="mesas-container" id="mesasContainer">
                <div class="empty-state">
                    <i class="fas fa-chair"></i>
                    <p>Selecciona un evento para ver las mesas</p>
                </div>
            </div>
        </section>

        <!-- COLUMNA 3: Panel de Configuraci√≥n -->
        <aside class="config-panel">
            <div class="tabs">
                <button class="tab active" data-tab="config">
                    <i class="fas fa-cog"></i> Configuraci√≥n
                </button>
                <button class="tab" data-tab="invitados">
                    <i class="fas fa-users"></i> Invitados
                </button>
            </div>

            <!-- Tab Configuraci√≥n -->
            <div class="tab-content active" id="configTab">
                <div class="config-section">
                    <h3><i class="fas fa-info-circle"></i> Informaci√≥n del Evento</h3>
                    <div class="form-group">
                        <label for="eventName">Nombre del Evento *</label>
                        <input type="text" id="eventName" placeholder="Nombre del evento">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="eventDate">Fecha</label>
                            <input type="date" id="eventDate">
                        </div>
                        <div class="form-group">
                            <label for="eventTime">Hora</label>
                            <input type="time" id="eventTime">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="eventDescription">Descripci√≥n</label>
                        <textarea id="eventDescription" rows="3" placeholder="Descripci√≥n del evento"></textarea>
                    </div>
                    <button class="btn-primary" id="btnGuardarEvento">
                        <i class="fas fa-save"></i> Guardar Cambios
                    </button>
                </div>

                <div class="config-section">
                    <h3><i class="fas fa-table"></i> Configuraci√≥n de Mesas</h3>
                    <div class="form-group">
                        <label for="numMesas">N√∫mero de Mesas</label>
                        <input type="number" id="numMesas" min="1" max="50" value="8">
                    </div>
                    <div class="form-group">
                        <label for="sillasPorMesa">Sillas por Mesa</label>
                        <input type="number" id="sillasPorMesa" min="2" max="20" value="8">
                    </div>
                    <div class="form-group">
                        <label for="formaMesa">Forma de las Mesas</label>
                        <select id="formaMesa">
                            <option value="rectangular">üìê Rectangular</option>
                            <option value="cuadrada">‚¨ú Cuadrada</option>
                            <option value="circular">‚≠ï Circular</option>
                        </select>
                    </div>
                    <button class="btn-primary" id="btnCrearMesas">
                        <i class="fas fa-plus-circle"></i> Crear/Actualizar Mesas
                    </button>
                </div>

                <div class="danger-zone">
                    <h3><i class="fas fa-exclamation-triangle"></i> Zona Peligrosa</h3>
                    <button class="btn-eliminar-evento" id="btnFinalizarEvento" onclick="confirmarEliminarEvento()">
                        <i class="fas fa-trash-alt"></i> Eliminar Evento
                    </button>
                </div>
            </div>

            <!-- Tab Invitados -->
            <div class="tab-content" id="invitadosTab">
                <div class="invitados-header">
                    <input type="text" id="searchInvitado" placeholder="Buscar invitado..." class="search-input">
                    <button class="btn-invitado btn-primary" id="addGuestBtn">
                        <i class="fas fa-user-plus"></i> Agregar Invitado
                    </button>
                </div>

                <div class="invitados-filters">
                    <select id="filterInvitados">
                        <option value="">Todos los invitados</option>
                        <option value="confirmado">Confirmados</option>
                        <option value="pendiente">Pendientes</option>
                        <option value="rechazado">Rechazados</option>
                        <option value="sin-asignar">Sin asignar</option>
                    </select>
                </div>

                <div class="invitados-list" id="invitadosList">
                    <div class="empty-invitados">
                        <i class="fas fa-user-friends"></i>
                        <p>No hay invitados agregados</p>
                        <small>Agrega invitados para comenzar</small>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- Modal Agregar Invitado PRO -->
    <div class="modal modal-invitado" id="addGuestModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-plus"></i> Agregar Nuevo Invitado</h2>
                <button class="modal-close" onclick="cerrarModal('addGuestModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addGuestForm">
                    <div class="form-group">
                        <label for="guestName">Nombre Completo *</label>
                        <input type="text" id="guestName" placeholder="Ej: Mar√≠a Garc√≠a L√≥pez" required>
                    </div>
                    <div class="form-group">
                        <label for="guestEmail">Correo Electr√≥nico</label>
                        <input type="email" id="guestEmail" placeholder="maria@ejemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="guestPhone">Tel√©fono</label>
                        <input type="tel" id="guestPhone" placeholder="+52 123 456 7890">
                    </div>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Guardar Invitado
                    </button>
                    <button type="button" class="btn-secondary" onclick="cerrarModal('addGuestModal')">Cancelar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Confirmaci√≥n Logout -->
    <div id="modalLogout" class="modal">
        <div class="modal-content" style="max-width: 450px; text-align: center">
            <div style="width:80px; height:80px; margin:0 auto 24px; background:linear-gradient(135deg, #f44336, #d32f2f); border-radius:50%; display:flex; align-items:center; justify-content:center">
                <i class="fas fa-sign-out-alt" style="font-size:2.5rem; color:white"></i>
            </div>
            <h2 style="margin:0 0 12px 0; font-size:1.8rem; color:#2d3748">¬øCerrar Sesi√≥n?</h2>
            <p style="color:#718096; margin:0 0 32px 0; font-size:1.05rem">Tu sesi√≥n se cerrar√° y tendr√°s que volver a iniciar sesi√≥n</p>
            <div style="display:flex; gap:12px">
                <button onclick="cerrarModalLogout()" style="flex:1; padding:16px; background:#e2e8f0; color:#2d3748; border:none; border-radius:12px; cursor:pointer; font-weight:600; font-size:1rem">
                    Cancelar
                </button>
                <button onclick="confirmarLogout()" style="flex:1; padding:16px; background:linear-gradient(135deg, #f44336, #d32f2f); color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600; font-size:1rem; box-shadow: 0 4px 12px rgba(244,67,54,0.3)">
                    S√≠, Salir
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Confirmaci√≥n Eliminar Evento -->
    <div id="modalEliminarEvento" class="modal">
        <div class="modal-content" style="max-width: 450px; text-align: center">
            <div style="width:80px; height:80px; margin:0 auto 24px; background:linear-gradient(135deg, #f44336, #d32f2f); border-radius:50%; display:flex; align-items:center; justify-content:center">
                <i class="fas fa-exclamation-triangle" style="font-size:2.5rem; color:white"></i>
            </div>
            <h2 style="margin:0 0 12px 0; font-size:1.8rem; color:#2d3748">¬øEliminar Evento?</h2>
            <p style="color:#718096; margin:0 0 32px 0; font-size:1.05rem">Esta acci√≥n no se puede deshacer. Se eliminar√°n todas las mesas e invitados.</p>
            <div style="display:flex; gap:12px">
                <button onclick="cerrarModalEliminar()" style="flex:1; padding:16px; background:#e2e8f0; color:#2d3748; border:none; border-radius:12px; cursor:pointer; font-weight:600; font-size:1rem">
                    Cancelar
                </button>
                <button onclick="ejecutarEliminarEvento()" style="flex:1; padding:16px; background:linear-gradient(135deg, #f44336, #d32f2f); color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600; font-size:1rem; box-shadow: 0 4px 12px rgba(244,67,54,0.3)">
                    S√≠, Eliminar
                </button>
            </div>
        </div>
    </div>

    <div id="messageToast" class="toast"></div>
    
    <script src="login.js"></script>
    <script src="cliente.js"></script>
    
    <script>
        function cerrarModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.getElementById(modalId).style.display = 'none';
        }
        
        function mostrarConfirmacionLogout() {
            document.getElementById('modalLogout').classList.add('active');
            document.getElementById('modalLogout').style.display = 'flex';
        }
        
        function cerrarModalLogout() {
            document.getElementById('modalLogout').classList.remove('active');
            document.getElementById('modalLogout').style.display = 'none';
        }
        
        function confirmarLogout() {
            localStorage.clear();
            sessionStorage.clear();
            window.location.href = 'login.html';
        }
        
        function confirmarEliminarEvento() {
            document.getElementById('modalEliminarEvento').classList.add('active');
            document.getElementById('modalEliminarEvento').style.display = 'flex';
        }
        
        function cerrarModalEliminar() {
            document.getElementById('modalEliminarEvento').classList.remove('active');
            document.getElementById('modalEliminarEvento').style.display = 'none';
        }
        
        function ejecutarEliminarEvento() {
            if (typeof finalizarEvento === 'function') {
                finalizarEvento();
            }
            cerrarModalEliminar();
        }
    </script>
</body>
</html>
